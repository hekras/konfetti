<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>Konfetti misser</title>
    <style type="text/css">
        * {
            margin: 0;
            background: rgb(0, 0, 0);
            border: 0px;
        }
    </style>
</head>

<body>
    <canvas></canvas>
    <script>
        var statemachine = 0;
        var tick = 0;
        const dtick = 0.1;
        var star = [];

        misser = document.createElement('canvas');

        function animateloop() {
            dc.clearRect(0, 0, width, height);

            switch (statemachine) {
                case 0:
                    star = [];
                    for (var i = 0; i < 30; i++) {
                        star[i] = {
                            x: Math.random() * width,
                            y: Math.random() * height,
                            dy: Math.random() * 5,
                            size: 4.0,
                            dsize: 1 - 0.01 * Math.random(),
                            maxscale: 0.1,
                            targetangle: 0.5,
                            dangle: Math.random() * 0.03,
                            mangle: Math.random() * 3.1457,
                        };
                    }
                    statemachine = 1;
                    break;
            }

            for (var i = 0; i < star.length; i++) {
                dc.save();
                dc.translate(star[i].x, star[i].y);
                var scale = star[i].size;
                dc.scale(scale, scale);
                dc.rotate(star[i].mangle);
                dc.translate(-misser.width / 2, - misser.height / 2);
                dc.drawImage(misser, 0, 0);
                dc.restore();
                star[i].y += star[i].dy;
                star[i].mangle += star[i].dangle;
                star[i].size *= star[i].dsize;
                if ((star[i].y > height + 80.0) || (star[i].size < 0.005)) {
                    star[i] = {
                        x: Math.random() * width,
                        y: -200,
                        dy: 1.5 + Math.random() * 8,
                        size: 4.0,
                        dsize: 1 - 0.01 * Math.random(),
                        maxscale: 0.1,
                        targetangle: 0.5,
                        dangle: 0.1 * (Math.random() - 0.5),
                        mangle: Math.random() * 3.1457,
                    };
                }
            }
        }

        /***********************************
        // main - program starts here !!!!!!
        ************************************/
        const canvas = document.querySelector("canvas");
        const width = canvas.width = window.innerWidth;
        const height = canvas.height = window.innerHeight;
        const dc = canvas.getContext("2d");

        misser.width = 500;
        misser.height = 500;
        var misserdc = misser.getContext('2d');
        misserdc.save();
        misserdc.scale(2,2);
        misserdc.translate(125, 125);
        misserdc.strokeStyle = "Yellow";
        misserdc.scale(0.1, 0.1);
        misserdc.lineWidth = 3;
        misserdc.beginPath();
        misserdc.lineTo(-0.05058, -16.771209);
        misserdc.lineTo(-1.40512, -14.905512);
        misserdc.lineTo(-5.54724, -11.601373);
        misserdc.lineTo(-11.57766, -7.096828);
        misserdc.lineTo(-16.62438, -1.209467);
        misserdc.lineTo(-17.86506, 5.612500);
        misserdc.lineTo(-14.57386, 11.36275);
        misserdc.lineTo(-8.65170, 13.44752);
        misserdc.lineTo(-3.24035, 11.16190);
        misserdc.lineTo(-0.46455, 7.02084);
        misserdc.lineTo(0.00000, 5.00000);
        misserdc.lineTo(0.46455, 7.02084);
        misserdc.lineTo(3.24035, 11.16190);
        misserdc.lineTo(8.65170, 13.44752);
        misserdc.lineTo(14.57386, 11.36275);
        misserdc.lineTo(17.86506, 5.61250);
        misserdc.lineTo(16.62438, -1.20946);
        misserdc.lineTo(11.57766, -7.09682);
        misserdc.lineTo(5.54724, -11.60137);
        misserdc.lineTo(1.40512, -14.90551);
        misserdc.lineTo(0.05058, -16.77120);
        misserdc.scale(2, 2);
        misserdc.moveTo(-30.05058, -20.771209);
        misserdc.lineTo(-70.05058, -36.771209)
        misserdc.moveTo(30.05058, -20.771209);
        misserdc.lineTo(70.05058, -36.771209)
        misserdc.moveTo(-30.05058, -6.771209);
        misserdc.lineTo(-70.05058, -10.771209)
        misserdc.moveTo(30.05058, -6.771209);
        misserdc.lineTo(70.05058, -10.771209)
        misserdc.moveTo(30.05058, 8.771209);
        misserdc.lineTo(70.05058, 15.771209)
        misserdc.moveTo(-30.05058, 8.771209);
        misserdc.lineTo(-70.05058, 15.771209)
        misserdc.moveTo(70.0, 80.0);
        misserdc.lineTo(60.0, 110.0)
        misserdc.lineTo(30.0, 85.0)
        misserdc.moveTo(60.0, 90.0);
        misserdc.lineTo(55.0, 100.0)
        misserdc.lineTo(40.0, 85.0)
        misserdc.moveTo(-70.0, 80.0);
        misserdc.lineTo(-60.0, 110.0)
        misserdc.lineTo(-30.0, 85.0)
        misserdc.moveTo(-60.0, 90.0);
        misserdc.lineTo(-55.0, 100.0)
        misserdc.lineTo(-40.0, 85.0)
        misserdc.stroke();



        window.setInterval(animateloop, 1000 / 60);

    </script>
</body>

</html>